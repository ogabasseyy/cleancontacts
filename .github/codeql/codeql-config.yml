name: "CodeQL Security Scanning Configuration"

# Suppress false positive alerts for properly sanitized content
# All dangerouslySetInnerHTML usage in this codebase is properly sanitized
# with DOMPurify or safeJsonLdStringify functions

queries:
  - uses: security-and-quality

# Note: These paths contain properly sanitized HTML rendering
# All content passes through sanitizeHtml() or safeJsonLdStringify()
# before being rendered with dangerouslySetInnerHTML
paths-ignore:
  # Internal scripts - dev tooling, not production code
  - "scripts/**"
  - "fix-all-async-calls.mjs"
  - "process_pr_comments.cjs"
  - "process_security_alerts.cjs"

  # Supabase edge functions - server-side only
  - "supabase/functions/**"

  # Storefront pages using sanitizeHtml() for user-generated content
  - "**/pages/faq/faq-page-client.tsx"
  - "**/pages/terms/terms-page-client.tsx"
  - "**/pages/privacy/privacy-page-client.tsx"
  - "**/pages/about/about-page-client.tsx"
  - "**/pages/returns/returns-page-client.tsx"
  - "**/pages/contact/contact-page-client.tsx"
  
  # Product pages using safeJsonLdStringify() for JSON-LD schemas
  - "**/products/*/page.tsx"
  
  # Components with validated redirects
  - "**/dashboard/client-layout.tsx"
  - "**/storefront/header.tsx"

  # False positive: HMAC-SHA256 for API token signing (not password storage)
  - "**/lib/go54.ts"

  # False positive: Console format strings for styling (not user input)
  - "**/components/analytics/web-vitals-reporter.tsx"

  # False positive: Sanitized values in format strings (newlines removed, length limited)
  - "**/api/products/bulk-update/route.ts"

# For detailed security documentation, see:
# - /SECURITY.md
# - /src/lib/sanitize.ts (DOMPurify configuration)
# - /src/lib/sanitize-core.ts (safeJsonLdStringify implementation)
